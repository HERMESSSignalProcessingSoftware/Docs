
%Detailiertes blockdiagramm
\begin{landscape}
\begin{figure}[h]
\begin{tikzpicture}[very thick, black, node distance=6cm]
\node[gray!50] (S1name) {\small{STAMP \# 1}};
\node[bigSensor, black, below of = S1name, node distance = 2cm] (S1SGR1) {SGR 1};
\node[bigSensor, black, below of = S1SGR1, node distance = 3cm] (S1pt100) {PT100};
\node[bigSensor, black, below of = S1pt100, node distance = 3cm] (S1SGR2) {SGR 2};

\node[rectangle, draw, gray!50, very thick, fit  = (S1name) (S1SGR2), inner sep= 2mm, outer sep = 2mm] (S1all) {};

\node[bigSensor, right of = S1SGR1] (S1SGR1adc) {ADS1147}; 
\node[bigSensor, right of = S1pt100] (S1pt100adc) {ADS1147};
\node[bigSensor, right of = S1SGR2] (S1SGR2adc) {ADS1147};

\coordinate (data11) at ($(S1SGR1) + (1.5cm, 1cm)$);
\coordinate (data12) at ($(S1SGR1) + (1.5cm, -1cm)$);
\coordinate (data21) at ($(S1pt100) + (1.5cm, 1cm)$);
\coordinate (data22) at ($(S1pt100) + (1.5cm, -1cm)$);
\coordinate (data31) at ($(S1SGR2) + (1.5cm, 1cm)$);
\coordinate (data32) at ($(S1SGR2) + (1.5cm, -1cm)$);

\coordinate (data13) at ($(S1SGR1adc) - (1.5cm, 1cm)$);
\coordinate (data14) at ($(S1SGR1adc) - (1.5cm, -1cm)$);
\coordinate (data23) at ($(S1pt100adc) - (1.5cm, 1cm)$);
\coordinate (data24) at ($(S1pt100adc) - (1.5cm, -1cm)$);
\coordinate (data33) at ($(S1SGR2adc) - (1.5cm, 1cm)$);
\coordinate (data34) at ($(S1SGR2adc) - (1.5cm, -1cm)$);

\path[black, very thick, draw] (data11)--(data14);
\path[black, very thick, draw] (data12)--(data13);

\path[black, very thick, draw] (data21)--(data24);
\path[black, very thick, draw] (data22)--(data23);

\path[black, very thick, draw] (data31)--(data34);
\path[black, very thick, draw] (data32)--(data33);

\node[black, right of = S1SGR1adc, node distance = 8cm] (F1S1name) {\small{c STAMP \#1}};
\node[bigSensor, below of = F1S1name, node distance = 2cm] (F1S1spi) {SPI};
\node[bigSensor, right of = F1S1spi, node distance =3.5cm] (F1S1cu) {CU};
\node[rectangle, draw, below of = F1S1spi, black, node distance = 2.5cm, minimum width = 6.5cm, minimum height = 1cm] (F1S1rl) at ($(F1S1spi)!0.5!(F1S1cu)$) {ResetLogic};
\node[rectangle, draw, below of = F1S1rl, node distance = 1.5cm, minimum width = 6.5cm, minimum height = 1cm] (F1S1amba) {AMBA Connector};
\node[rectangle, draw, black, very thick, fit  = (F1S1name) (F1S1spi) (F1S1cu)(F1S1rl) (F1S1amba), inner sep=2mm, outer sep = 2mm] (compStamp1) {};

\coordinate (spirl1) at ($(F1S1spi) + (0cm, -1.5cm)$);
\coordinate (spirl2) at ($(F1S1rl) + (-1.5cm, 1cm)$);
\path[black, draw, ultra thick] (spirl1) -- (spirl2);

\coordinate (curl1) at ($(F1S1cu) + (0cm, -1.5cm)$);
\coordinate (curl2) at ($(F1S1rl) + (1.5cm, 1cm)$);
\path[black, draw, ultra thick] (curl1) -- (curl2);

\coordinate (pocADC11) at ($(S1SGR1adc) + (1.5cm, 1cm)$);
\coordinate (pocADC12) at ($(S1SGR1adc) + (1.5cm, -1cm)$);
\coordinate (pocADC13) at ($(S1SGR1adc) + (1.5cm, 0cm)$);

\coordinate (pocADC21) at ($(S1pt100adc) + (1.5cm, 1cm)$);
\coordinate (pocADC22) at ($(S1pt100adc) + (1.5cm, -1cm)$);
\coordinate (pocADC23) at ($(S1pt100adc) + (1.5cm, 0cm)$);

\coordinate (pocADC31) at ($(S1SGR2adc) + (1.5cm, 1cm)$);
\coordinate (pocADC32) at ($(S1SGR2adc) + (1.5cm, -1cm)$);
\coordinate (pocADC33) at ($(S1SGR2adc) + (1.5cm, 0cm)$);

\coordinate (pocSpi) at ($(F1S1spi) - (1.5cm, 0cm)$);
\coordinate (pocrl) at ($(F1S1rl) - (3cm, 0cm)$);
\coordinate (pocADC32) at ($(S1SGR2adc) + (1.5cm, -1cm)$);

\coordinate (pocCU) at ($(F1S1cu) + (0cm, 1.5cm)$);
%SPI 
\path[black, draw, line width = 3pt] (pocADC11) -- + (2cm, 0cm);
\path[black, draw, line width = 3pt] (pocADC21) -- + (2cm, 0cm);
\path[black, draw, line width = 3pt] (pocADC31) -- + (2cm, 0cm);
\path[black, draw, line width = 3pt] (pocADC11) -- + (2cm, 0cm) -- ($(pocADC31) + (2cm, -0.05cm)$); 
\path[black, draw, line width = 3pt] (pocSpi) -- + (-3cm, 0cm);

%DRDY 
\path[gray!70, draw, line width = 2pt] (pocADC13) -- +(2.5cm,0cm) ;
\path[gray!70, draw, line width = 2pt] (pocADC23) -- +(2.5cm,0cm);
\path[gray!70, draw, line width = 2pt] (pocADC33) -- +(2.5cm,0cm);
\path[gray!70, draw, line width = 2pt] (pocADC13) -- +(2.5cm,0cm) --  ($(pocADC33) + (2.5cm, -0.04cm)$);
\path[gray!70, draw, line width = 2pt] ($(pocADC13) +(2.5cm,0cm)$) -- ($(pocADC13) + (2.5cm, 2cm)$) -- ($(pocCU) + (0cm, 2.5cm)$) -- (pocCU); 
%Interner Datenbus
\coordinate (compDB) at ($(F1S1cu) + (1.5cm,0cm)$);
\path[blue, draw, line width = 5pt] (compDB) -- +(1.5cm,0cm) node[right]{48bit Datenbus};
%Write enable
%\coordinate (WEcomp) at ($(F1S1cu) + (1.5cm, -1cm)$);
%\path[blue, draw, line width = 2pt] (WEcomp) --+(1.5cm, 0cm) node[right]{Write Enable};
%Enable
\coordinate (Ecomp) at ($(compStamp1) + (3.45cm, -1cm)$);
\path[blue, draw, line width = 2pt] (Ecomp) -- +(1.3cm, 0cm) node[right]{Enable};
%clk
\coordinate (clkcomp) at ($(compStamp1) + (3.45cm, -2cm)$);
\path[blue, draw, line width = 2pt] (clkcomp) -- +(1.3cm, 0cm) node[right]{clk};
%clk
\coordinate (rstcomp) at ($(compStamp1) + (3.45cm, -3cm)$);
\path[blue, draw, line width = 2pt] (rstcomp) -- +(1.3cm, 0cm) node[right]{$\overline{reset}$};
%DataReady
\coordinate (drdycomp) at ($(compStamp1) + (3.45cm, 2cm)$);
\path[blue, draw, line width = 2pt] (drdycomp) -- +(1.3cm, 0cm) node[right]{$\overline{Data Ready}$};
%Amba bus
\coordinate (ambaC) at ($(compStamp1) + (3.45cm, 0cm)$);
\path[blue, draw, line width = 3pt] (ambaC) -- +(1.3cm, 0cm) node[right]{AMBA};
%legende
\coordinate (l) at ($(F1S1cu) + (2.5cm, 4.5cm)$);
\coordinate (l2) at ($(F1S1cu) + (2cm, 4cm)$);
\coordinate (l3) at ($(F1S1cu) + (2cm, 3.5cm)$);
\coordinate (l4) at ($(F1S1cu) + (2cm, 2.5cm)$);
\node at (l) (legende) {Legende};
\path[gray!70, draw, line width = 2pt] (l2)-- + (1cm,0cm) node[right](drdy){$\overline{DRDYn}$};
\path[black, draw, line width = 3pt] (l3) -- +(1cm, 0cm) node[right](intDB){SPI};
\node[below of = intDB, node distance = .5cm] (intSPI) {Din, Dout, Sclk, $\overline{CSn}$};
%\path[blue, draw, line width = 5pt] (l4) --+(1cm,0cm) node[right](databus){48bit Datenbus};
\begin{pgfonlayer}{background}
	\node[rectangle, draw, black, fill=white, fit=(legende)(drdy) (intDB) (intSPI), inner sep = 1mm, outer sep = 1mm, rounded corners = .5cm] (legendeall){};
\end{pgfonlayer}
\end{tikzpicture}
\caption{Messstelle, Digitalisierung, Datenverarbeitung}
\label{fig:Stamp}
\end{figure}
\end{landscape}
